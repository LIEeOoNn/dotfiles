# sketchybarrc
#!/bin/bash

source "$CONFIG_DIR/colors.sh" # Loads all defined colors

PLUGIN_DIR="$CONFIG_DIR/plugins"

sketchybar --bar position=top height=20 blur_radius=20 color=0x40000000 

default=(
  padding_left=2
  padding_right=2
  icon.font="MesloLGS Nerd Font Mono:Bold:15.0"
  label.font="MesloLGS Nerd Font Mono:Bold:15.0"
  icon.color=$WHITE
  label.color=$WHITE
  icon.padding_left=2
  icon.padding_right=2
  label.padding_left=2
  label.padding_right=2
)
sketchybar --default "${default[@]}"

##### Adding Left Items #####

# Add Apple Menu Item
sketchybar --add item apple.logo left \
           --set apple.logo icon=\
                           label.drawing=off \
                           padding_right=15 \
                           click_script="sketchybar --trigger apple_menu"

# Add Aerospace workspace event handler
sketchybar --add event aerospace_workspace_change

# Add workspace manager with correct subscription
sketchybar --add item workspace_manager left \
           --set workspace_manager \
           script="$PLUGIN_DIR/workspace_manager.sh" \
           --subscribe workspace_manager aerospace_workspace_change

# Add workspace indicators
# for sid in $(/opt/homebrew/bin/aerospace list-workspaces --monitor focused --empty no); do
#     sketchybar --add item space.$sid left \
#         --subscribe space.$sid aerospace_workspace_change \
#         --set space.$sid \
#         background.color=0x44ffffff \
#         background.corner_radius=4 \
#         background.height=20 \
#         background.drawing=off \
#         label="$sid" \
#         click_script="/opt/homebrew/bin/aerospace workspace $sid" \
#         script="$PLUGIN_DIR/space.sh $sid"
# done

##### adding center items #####
sketchybar --add item front_app center \
           --set front_app icon.drawing=on \
                          label.drawing=on \
                          script="$PLUGIN_DIR/front_app.sh" \
           --subscribe front_app front_app_switched

##### Adding Right Items #####

sketchybar --add item clock right \
           --set clock update_freq=10 icon= script="$PLUGIN_DIR/clock.sh" \
           --add item battery right \
           --set battery update_freq=120 script="$PLUGIN_DIR/battery.sh" \
           --subscribe battery system_woke power_source_change \
           --add item volume right \
           --set volume script="$PLUGIN_DIR/volume.sh" \
           --subscribe volume volume_change \
           --add item network right \
           --set network script="$PLUGIN_DIR/network.sh" \
                         update_freq=10 label.drawing=off \

##### Force all scripts to run the first time (never do this in a script) #####
sketchybar --update